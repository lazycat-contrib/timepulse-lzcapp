(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{4625:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(5915)}])},5915:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return q}});var r=a(1527),n=a(959),s=a(2349),i=a(1621),o=a(1481),l=a(8119),c=a(2555),d=a(6163),m=a(6616),u=a(307),x=a(6231),h=a(9929),y=a(2950),g=a(3786);function b(e){let{onClose:t}=e,{timers:a,addTimer:s}=(0,m.H)(),{accentColor:o}=(0,u.Fg)(),{t:l}=(0,x.$)(),[c,b]=(0,n.useState)(""),[p,f]=(0,n.useState)(""),[v,j]=(0,n.useState)(""),[w,k]=(0,n.useState)(""),[N,C]=(0,n.useState)(""),[z,E]=(0,n.useState)(!1),[S,A]=(0,n.useState)("idle"),[F,T]=(0,n.useState)(!1),[D,L]=(0,n.useState)(""),[I,P]=(0,n.useState)(""),[M,B]=(0,n.useState)(!1),[_,H]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=localStorage.getItem("timepulse_sync_id"),t=localStorage.getItem("timepulse_sync_password");if(e){b(e),A("saved"),t&&j(t);let a="".concat(window.location.origin).concat(window.location.pathname,"?syncId=").concat(e).concat(t?"&syncPass=".concat(t):"");f(a)}},[]),(0,n.useEffect)(()=>{let e=()=>{H(!navigator.onLine)};return e(),window.addEventListener("online",e),window.addEventListener("offline",e),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e)}},[]),(0,n.useEffect)(()=>{let e=()=>{c&&v&&q()};return window.addEventListener("appOnline",e),()=>window.removeEventListener("appOnline",e)},[c,v]);let R=async()=>{T(!0),L("");let e=(0,y.Z)(),t=Math.random().toString(36).substring(2,10);b(e),j(t);try{localStorage.setItem("timepulse_sync_id",e),localStorage.setItem("timepulse_sync_password",t);let r="".concat(window.location.origin).concat(window.location.pathname,"?syncId=").concat(e,"&syncPass=").concat(t);f(r),await (0,g.E)(e,t,{timers:a},2592e6),A("saved"),P(l("login.generated")),console.log("".concat(l("login.syncIdSaved"),": ").concat(e," - ").concat(new Date().toLocaleString()))}catch(e){L("".concat(l("login.generateError"),": ").concat(e.message)),console.error("同步数据保存失败:",e),A("generated")}finally{T(!1)}},O=async()=>{T(!0),L("");try{localStorage.setItem("timepulse_sync_id",c),localStorage.setItem("timepulse_sync_password",v),await (0,g.E)(c,v,{timers:a},2592e6),A("saved"),P("同步数据已保存到云端"),console.log("".concat(l("login.syncIdSaved"),": ").concat(c," - ").concat(new Date().toLocaleString()))}catch(e){L("保存失败: ".concat(e.message)),console.error("同步数据保存失败:",e)}finally{T(!1)}},q=async e=>{e&&e.preventDefault(),T(!0),L(""),P("");try{let e=await (0,g.e)(w||c,N||v);if(e&&e.timers&&Array.isArray(e.timers)&&e.timers.length>0){if(e.timers.forEach(e=>{s(e)}),w){localStorage.setItem("timepulse_sync_id",w),localStorage.setItem("timepulse_sync_password",N),b(w),j(N),A("saved");let e="".concat(window.location.origin).concat(window.location.pathname,"?syncId=").concat(w,"&syncPass=").concat(N);f(e)}P("成功导入 ".concat(e.timers.length," 个计时器")),console.log("已从远程同步 ".concat(e.timers.length," 个计时器 - ").concat(new Date().toLocaleString()))}else L("远程数据无效或不包含计时器")}catch(t){let e="查询成功"===t.message?"远程数据格式错误或为空":t.message;L("加载失败: ".concat(e)),console.error("从远程加载数据失败:",t)}finally{T(!1)}},W=async()=>{T(!0),L(""),P("");try{await (0,g.E)(c,v,{timers:a},2592e6),P("成功上传 ".concat(a.length," 个计时器到云端")),console.log("已上传 ".concat(a.length," 个计时器到远程 - ").concat(new Date().toLocaleString()))}catch(e){L("上传失败: ".concat(e.message)),console.error("上传数据到远程失败:",e)}finally{T(!1)}};return(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[600] backdrop-blur-sm overflow-y-auto py-4",onClick:t,children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-md m-4 p-6 rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:l("login.title")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),_&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 rounded-lg flex items-center",children:[(0,r.jsx)(d.Hov,{className:"mr-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"您当前处于离线模式，同步功能不可用。请恢复网络连接后重试。"})]}),D&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-lg",children:D}),I&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-lg",children:I}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:l("login.description")}),"idle"===S&&(0,r.jsxs)("div",{className:"flex mb-4",children:[(0,r.jsx)("button",{className:"flex-1 py-2 border-b-2 ".concat(M?"border-gray-300 text-gray-500":"border-primary-500 text-primary-500"),onClick:()=>B(!1),children:l("login.generateId")}),(0,r.jsx)("button",{className:"flex-1 py-2 border-b-2 ".concat(M?"border-primary-500 text-primary-500":"border-gray-300 text-gray-500"),onClick:()=>B(!0),children:l("login.useExistingId")})]}),"idle"===S&&!M&&(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("button",{className:"btn-glass-primary",onClick:R,"data-umami-event":l("login.generateId"),disabled:F,children:F?l("login.generating"):l("login.generateId")})}),"idle"===S&&M&&(0,r.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("login.syncId")}),(0,r.jsx)("input",{type:"text",value:w,onChange:e=>k(e.target.value),placeholder:l("login.syncIdPlaceholder","输入您的同步ID"),className:"w-full px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("login.password")}),(0,r.jsx)("input",{type:"password",value:N,onChange:e=>C(e.target.value),placeholder:l("login.password"),className:"w-full px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none",required:!0})]}),(0,r.jsxs)("button",{type:"submit",className:"w-full btn-glass-primary flex items-center justify-center",disabled:F,"data-umami-event":l("login.loginAndSync"),children:[(0,r.jsx)(d._hL,{className:"mr-2"}),F?l("common.loading"):l("login.loginAndSync")]})]}),("generated"===S||"saved"===S)&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("login.yourSyncId","您的同步ID")}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("input",{type:"text",value:c,readOnly:!0,className:"flex-1 px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"}),"generated"===S&&(0,r.jsx)("button",{className:"ml-2 btn-glass-primary",onClick:O,"data-umami-event":"保存同步ID",disabled:F,children:(0,r.jsx)(d.mW3,{})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("login.passwordLabel","密码")}),(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("input",{type:"text",value:v,readOnly:!0,className:"flex-1 px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("login.syncLink","同步链接")}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("input",{type:"text",value:p,readOnly:!0,className:"flex-1 px-4 py-2 rounded-l-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"}),(0,r.jsx)("button",{className:"btn-glass-primary rounded-r-lg rounded-l-none ".concat(z?"bg-green-500/30 border-green-500/40":""),onClick:()=>{navigator.clipboard.writeText(p).then(()=>{E(!0),setTimeout(()=>E(!1),2e3)}).catch(e=>{L("无法复制URL: ".concat(e.message)),console.error("复制URL失败:",e)})},"data-umami-event":"复制同步链接",children:z?(0,r.jsx)(d.UgA,{}):(0,r.jsx)(d.C3L,{})})]})]}),"saved"===S&&(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{className:"flex-1 btn-glass-primary flex items-center justify-center ".concat(_?"opacity-50 cursor-not-allowed":""),onClick:_?null:W,"data-umami-event":"上传数据",disabled:F||_,children:[(0,r.jsx)(d.Yjd,{className:"mr-2"}),F?l("login.uploading","上传中..."):l("login.uploadData","上传当前数据")]}),(0,r.jsxs)("button",{className:"flex-1 btn-glass-primary flex items-center justify-center ".concat(_?"opacity-50 cursor-not-allowed":""),onClick:_?null:q,"data-umami-event":"下载数据",disabled:F||_,children:[(0,r.jsx)(d._hL,{className:"mr-2"}),F?l("login.downloading","下载中..."):l("login.downloadData","下载最新数据")]})]}),(0,r.jsx)("div",{className:"flex justify-center mt-4",children:(0,r.jsx)("div",{className:"p-4 bg-white rounded-xl",children:(0,r.jsx)(h.tv,{value:p,size:200,level:"H",includeMargin:!0})})}),"saved"===S&&(0,r.jsxs)("div",{className:"text-center text-green-500 font-medium",children:["✓ ",l("login.syncIdSaved","同步ID已保存")]})]})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{className:"flex-1 btn-glass-secondary flex items-center justify-center z-[650]",onClick:t,disabled:F,children:l("common.close","关闭")}),("generated"===S||"saved"===S)&&navigator.share&&(0,r.jsxs)("button",{className:"flex-1 btn-glass-primary flex items-center justify-center z-[650]",onClick:()=>{navigator.share({title:"登录到我的TimePulse",text:"使用此链接登录并同步我的TimePulse倒计时",url:p})},"data-umami-event":"分享同步链接",disabled:F,children:[(0,r.jsx)(d.PMT,{className:"mr-2"}),l("login.shareButton","分享")]})]})]})})}var p=a(5438);function f(){let{timers:e,activeTimerId:t,setActiveTimerId:a,deleteTimer:s,updateTimer:l}=(0,m.H)(),{theme:c,toggleTheme:h,accentColor:y}=(0,u.Fg)(),{t:g,changeLanguage:f,currentLang:v}=(0,x.$)(),[j,w]=(0,n.useState)(!1),[k,N]=(0,n.useState)(!1),[C,z]=(0,n.useState)(!1),[E,S]=(0,n.useState)(!1),[A,F]=(0,n.useState)(null),[T,D]=(0,n.useState)(!1),[L,I]=(0,n.useState)(!1),P=()=>{z(!0),"#login"!==window.location.hash&&(window.location.hash="login")},M=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(e=>{console.error("错误: 无法进入全屏模式: ".concat(e.message))}),S(!E)},B=e=>{f(e),I(!1)},_=e=>{"countdown"!==e.type&&e.type?F({...e,isLimitedEdit:!0}):F({...e,targetDate:new Date(e.targetDate).toISOString().substring(0,10),targetTime:new Date(e.targetDate).toTimeString().substring(0,5)})};return(0,n.useEffect)(()=>{let e=()=>{S(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),e.find(e=>e.id===t),(0,r.jsxs)("header",{className:"fixed top-0 left-0 right-0 z-40",children:[(0,r.jsxs)("nav",{className:"glass-card mx-4 mt-4 px-6 py-4 flex md:grid md:grid-cols-3 items-center justify-between",children:[(0,r.jsx)(i.E.div,{className:"flex items-center justify-start",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:(0,r.jsx)("h1",{className:"text-xl md:text-2xl font-bold font-display bg-clip-text text-transparent",style:{backgroundImage:"linear-gradient(45deg, ".concat(y,", ").concat(y,"66)")},children:(0,r.jsx)("a",{href:"https://timepulse.ravelloh.top/",children:"TimePulse"})})}),(0,r.jsx)("div",{className:"hidden md:flex justify-center",children:(0,r.jsx)("div",{className:"flex space-x-4 overflow-x-auto py-2 max-w-md",children:(0,r.jsx)(o.M,{children:e.map(e=>(0,r.jsx)(i.E.button,{layout:!0,layoutId:"timer-".concat(e.id),initial:{opacity:.8,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:.8,scale:.95},transition:{duration:.2},className:"px-3 py-1 rounded-full text-sm font-medium transition-all whitespace-nowrap ".concat(t===e.id?"text-white":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),style:t===e.id?{backgroundColor:e.color||"#0ea5e9"}:{},onClick:()=>a(e.id),"data-umami-event":"切换计时器",children:e.name},e.id))})})}),(0,r.jsxs)("div",{className:"flex items-center justify-end",children:[(0,r.jsxs)("div",{className:"hidden md:flex items-center",children:[(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 cursor-pointer",onClick:M,"data-umami-event":E?g("header.exitFullscreen"):g("header.fullscreen"),children:E?(0,r.jsx)(d.Gbj,{className:"text-xl"}):(0,r.jsx)(d.ABE,{className:"text-xl"})}),(0,r.jsx)("button",{className:"p-2 ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 cursor-pointer",onClick:P,"data-umami-event":g("header.login"),children:(0,r.jsx)(d.fzv,{className:"text-xl"})}),(0,r.jsx)("button",{className:"p-2 ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 cursor-pointer",onClick:h,"data-umami-event":g("header.themeToggle"),children:"dark"===c?(0,r.jsx)(d.kXG,{className:"text-xl"}):(0,r.jsx)(d.wOW,{className:"text-xl"})}),(0,r.jsx)("button",{className:"p-2 ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 cursor-pointer",onClick:()=>I(!0),"data-umami-event":g("header.languageSelect"),children:(0,r.jsx)(d.RsK,{className:"text-xl"})}),(0,r.jsx)("button",{className:"p-2 ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 cursor-pointer",onClick:()=>{N(!0),"#manage"!==window.location.hash&&(window.location.hash="manage")},"data-umami-event":g("header.manage"),children:(0,r.jsx)(d.nbt,{className:"text-xl"})})]}),(0,r.jsxs)("div",{className:"flex items-center md:hidden",children:[(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 cursor-pointer",onClick:P,"data-umami-event":g("header.login"),children:(0,r.jsx)(d.fzv,{className:"text-xl"})}),(0,r.jsx)("button",{className:"p-2 ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 cursor-pointer",onClick:()=>w(!j),"data-umami-event":g("header.menu"),children:j?(0,r.jsx)(d.q5L,{className:"text-xl"}):(0,r.jsx)(d.cur,{className:"text-xl"})})]})]})]}),(0,r.jsx)(o.M,{children:j&&(0,r.jsxs)(i.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"glass-card mx-4 mt-2 p-4 md:hidden max-h-[70vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-3",children:g("header.functions")}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("button",{className:"flex items-center justify-between p-3 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-gray-200/60 dark:border-white/10 text-gray-700 dark:text-gray-300 hover:bg-white/20 dark:hover:bg-black/20 cursor-pointer transition-colors",onClick:()=>{M(),w(!1)},"data-umami-event":E?g("header.exitFullscreen"):g("header.fullscreen"),children:[E?(0,r.jsx)(d.Gbj,{className:"text-xl"}):(0,r.jsx)(d.ABE,{className:"text-xl"}),(0,r.jsx)("span",{className:"text-xs ml-2 flex-1 text-right",children:E?g("header.exitFullscreen"):g("header.fullscreen")})]}),(0,r.jsxs)("button",{className:"flex items-center justify-between p-3 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-gray-200/60 dark:border-white/10 text-gray-700 dark:text-gray-300 hover:bg-white/20 dark:hover:bg-black/20 cursor-pointer transition-colors",onClick:()=>{h(),w(!1)},"data-umami-event":g("header.themeToggle"),children:["dark"===c?(0,r.jsx)(d.kXG,{className:"text-xl"}):(0,r.jsx)(d.wOW,{className:"text-xl"}),(0,r.jsx)("span",{className:"text-xs ml-2 flex-1 text-right",children:g("header.themeToggle")})]}),(0,r.jsxs)("button",{className:"flex items-center justify-between p-3 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-gray-200/60 dark:border-white/10 text-gray-700 dark:text-gray-300 hover:bg-white/20 dark:hover:bg-black/20 cursor-pointer transition-colors",onClick:()=>{I(!0),w(!1)},"data-umami-event":g("header.languageSelect"),children:[(0,r.jsx)(d.RsK,{className:"text-xl"}),(0,r.jsx)("span",{className:"text-xs ml-2 flex-1 text-right",children:g("header.language")})]}),(0,r.jsxs)("button",{className:"flex items-center justify-between p-3 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-gray-200/60 dark:border-white/10 text-gray-700 dark:text-gray-300 hover:bg-white/20 dark:hover:bg-black/20 cursor-pointer transition-colors",onClick:()=>{N(!0),w(!1),"#manage"!==window.location.hash&&(window.location.hash="manage")},"data-umami-event":g("header.manage"),children:[(0,r.jsx)(d.nbt,{className:"text-xl"}),(0,r.jsx)("span",{className:"text-xs ml-2 flex-1 text-right",children:g("header.settings")})]})]})]}),e.length>0&&(0,r.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:g("header.timers")}),(0,r.jsx)("div",{className:"flex flex-col space-y-2 max-h-48 overflow-y-auto",children:e.map(e=>(0,r.jsx)(i.E.button,{layout:!0,initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{duration:.2},className:"px-4 py-2 rounded-lg text-left ".concat(t===e.id?"text-white":"bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-gray-200/60 dark:border-white/10 text-gray-700 dark:text-gray-300 hover:bg-white/20 dark:hover:bg-black/20"),style:t===e.id?{backgroundColor:e.color||"#0ea5e9"}:{},onClick:()=>{a(e.id),w(!1)},"data-umami-event":"移动端切换计时器",children:e.name},e.id))})]})]})}),(0,r.jsx)(o.M,{children:k&&(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 overflow-y-auto py-4",onClick:()=>{N(!1),F(null),"#manage"===window.location.hash&&(window.location.hash="")},children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-md m-4 p-6 rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:g("header.manage")}),(0,r.jsx)("button",{className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer",onClick:()=>{N(!1),F(null),"#manage"===window.location.hash&&(window.location.hash="")},children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),A?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:A.isLimitedEdit?g("modal.edit.editTimer"):g("modal.edit.editCountdown")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:g("modal.edit.name")}),(0,r.jsx)("input",{type:"text",value:A.name,onChange:e=>F({...A,name:e.target.value}),className:"w-full px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"})]}),!A.isLimitedEdit&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:g("modal.edit.date")}),(0,r.jsx)("input",{type:"date",value:A.targetDate,onChange:e=>F({...A,targetDate:e.target.value}),className:"w-full px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:g("modal.edit.time")}),(0,r.jsx)("input",{type:"time",value:A.targetTime,onChange:e=>F({...A,targetTime:e.target.value}),className:"w-full px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:g("modal.edit.color")}),(0,r.jsx)("div",{className:"h-10 w-full rounded-lg cursor-pointer",style:{backgroundColor:A.color},onClick:()=>D(!T)}),T&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(p.gW,{color:A.color,onChange:e=>F({...A,color:e}),className:"w-full"})})]}),(0,r.jsxs)("div",{className:"flex space-x-2 pt-2",children:[(0,r.jsx)("button",{className:"flex-1 btn-glass-secondary",onClick:()=>F(null),children:g("common.cancel")}),(0,r.jsxs)("button",{className:"flex-1 btn-glass-primary flex items-center justify-center",onClick:()=>{if(A){if(A.isLimitedEdit)l(A.id,{name:A.name,color:A.color});else{let e=new Date("".concat(A.targetDate,"T").concat(A.targetTime));l(A.id,{name:A.name,targetDate:e.toISOString(),color:A.color})}F(null),D(!1)}},"data-umami-event":g("modal.edit.saveChanges"),children:[(0,r.jsx)(d.mW3,{className:"mr-2"}),g("modal.edit.saveChanges")]})]})]}):(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto",children:e.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 mb-2 rounded-lg bg-white/30 dark:bg-black/30 hover:bg-white/50 dark:hover:bg-black/50",style:{borderLeft:"4px solid ".concat(e.color||"#0ea5e9")},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"stopwatch"===e.type?g("timer.stopwatch"):"worldclock"===e.type?"".concat(e.country||g("timer.worldClock")," - ").concat(e.timezone||""):new Date(e.targetDate).toLocaleString()})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{className:"p-1.5 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-900/50 cursor-pointer",onClick:()=>_(e),"data-umami-event":g("timer.editTimer"),children:(0,r.jsx)(d.vPQ,{})}),(0,r.jsx)("button",{className:"p-1.5 rounded-full bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/50 cursor-pointer",onClick:()=>s(e.id),"data-umami-event":g("timer.deleteTimer"),children:(0,r.jsx)(d.q5L,{})})]})]},e.id))})]})})}),(0,r.jsx)(o.M,{children:L&&(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:()=>I(!1),children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-sm m-4 p-6 rounded-2xl",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:g("header.selectLanguage")}),(0,r.jsx)("button",{className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer",onClick:()=>I(!1),children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("button",{className:"w-full px-4 py-3 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 hover:bg-white/20 dark:hover:bg-black/20 text-left transition-all cursor-pointer",onClick:()=>B("zh-CN"),"data-umami-event":g("header.chinese"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-2xl mr-3",children:"\uD83C\uDDE8\uD83C\uDDF3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:g("header.chinese")}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:g("header.chineseSimplified")})]})]})}),(0,r.jsx)("button",{className:"w-full px-4 py-3 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 hover:bg-white/20 dark:hover:bg-black/20 text-left transition-all cursor-pointer",onClick:()=>B("en-US"),"data-umami-event":g("header.english"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-2xl mr-3",children:"\uD83C\uDDFA\uD83C\uDDF8"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:g("header.english")}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:g("header.englishUS")})]})]})})]})]})})}),(0,r.jsx)(o.M,{children:C&&(0,r.jsx)(b,{onClose:()=>{z(!1),"#login"===window.location.hash&&(window.location.hash="")}})})]})}function v(){let{t:e}=(0,x.$)(),[t,a]=(0,n.useState)([]),[s,o]=(0,n.useState)(""),[l,c]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1),[h,y]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if("undefined"!=typeof navigator){c(!navigator.onLine);let e=()=>c(!1),t=()=>c(!0);return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}},[]),(0,n.useEffect)(()=>{let e=()=>{let e=new Date;o(e.toLocaleString())};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[]),(0,n.useEffect)(()=>{let e=console.log,t=[];return console.log=function(){for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];e.apply(console,n),t.push(n.join(" ")),t.length>50&&t.shift(),a([...t])},()=>{console.log=e}},[]),(0,n.useEffect)(()=>{let e=e=>{u(!1),y(new Date(e.detail.timestamp).toLocaleString())};return window.addEventListener("cacheUpdated",e),()=>window.removeEventListener("cacheUpdated",e)},[]),(0,r.jsx)("div",{className:"pointer-events-auto w-full flex items-start justify-center text-gray-800 dark:text-white px-4 py-8 pt-20 sm:pt-24 pb-8 sm:pb-12",children:(0,r.jsxs)("div",{className:"w-full max-w-4xl glass-card p-3 sm:p-4 md:p-6 rounded-2xl max-h-[calc(100vh-10rem)] sm:max-h-[calc(100vh-12rem)] overflow-y-auto mt-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg md:text-xl font-bold mb-2 md:mb-3 flex items-center text-gray-800 dark:text-white",children:[(0,r.jsx)(d.H33,{className:"mr-2"})," ",e("footer.about","关于 TimePulse")]}),(0,r.jsx)("p",{className:"mb-2 md:mb-3 text-sm text-gray-700 dark:text-gray-200",children:e("footer.description","TimePulse 是一个现代化的倒计时应用，支持多个计时器、数据同步和美观的动效展示。")}),(0,r.jsx)("div",{className:"mb-3 md:mb-4",children:(0,r.jsxs)("a",{href:"https://github.com/RavelloH/TimePulse",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-1.5 text-sm rounded-full bg-gray-600 hover:bg-gray-700 dark:bg-white/20 dark:hover:bg.white/30 text-white dark:text-white transition-colors","data-umami-event":e("footer.visitGitHub","访问GitHub"),children:[(0,r.jsx)(d.uOf,{className:"mr-1 md:mr-2"})," ",e("footer.gitHubRepo","GitHub 仓库")]})}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h3",{className:"text-sm md:text-base font-semibold mb-1 text-gray-800 dark:text-white",children:e("footer.features","功能特点")}),(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-0.5 text-xs md:text-sm text-gray-700 dark:text-gray-200",children:[(0,r.jsx)("li",{children:e("footer.feature1","精美的视觉效果和动画")}),(0,r.jsx)("li",{children:e("footer.feature2","支持多个计时器")}),(0,r.jsx)("li",{children:e("footer.feature3","数据本地存储")}),(0,r.jsx)("li",{children:e("footer.feature4","数据分享与同步")}),(0,r.jsx)("li",{children:e("footer.feature5","暗色/亮色主题")}),(0,r.jsx)("li",{children:e("footer.feature6","全屏模式")}),(0,r.jsx)("li",{children:e("footer.feature7","响应式设计")})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg md:text-xl font-bold mb-2 md:mb-3 flex items-center",children:[(0,r.jsx)(d.TCC,{className:"mr-2"})," ",e("footer.runLog","运行日志")]}),(0,r.jsx)("div",{className:"bg-gray-200/50 dark:bg-black/30 rounded-lg p-2 mb-2",children:(0,r.jsxs)("p",{className:"text-xs font-mono",children:[e("footer.currentTime","当前时间"),": ",s]})}),(0,r.jsx)("div",{className:"h-24 sm:h-32 md:h-48 overflow-y-auto bg-gray-200/50 dark:bg-black/30 rounded-lg p-2 font-mono text-xs",children:t.length>0?t.map((e,t)=>(0,r.jsx)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-1 break-words",children:e},t)):(0,r.jsx)("p",{className:"text-gray-400",children:e("footer.noLogs","暂无日志记录...")})})]})]}),(0,r.jsxs)("div",{className:"mt-3 md:mt-4 text-center opacity-70 flex flex-col items-center space-y-1",children:[l&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center justify-center",children:[(0,r.jsx)(d.Hov,{className:"mr-1 w-3 h-3"}),(0,r.jsx)("span",{children:e("footer.offlineMode","当前处于离线模式，部分功能可能不可用")})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("button",{className:"text-xs flex items-center justify-center px-2 py-1 rounded text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors ".concat(m?"opacity-50 cursor-wait":""),onClick:()=>{if("function"==typeof window.updateServiceWorkerCache){let e=window.updateServiceWorkerCache();e?(u(!0),console.log("已发送缓存更新请求")):console.log("无法更新缓存：Service Worker 未激活")}else console.log("缓存更新功能不可用")},disabled:m||l,title:e("footer.updateCache","更新应用缓存"),"data-umami-event":"更新缓存",children:[(0,r.jsx)(d.Bw1,{className:"mr-1 w-3 h-3 ".concat(m?"animate-spin":"")}),(0,r.jsx)("span",{children:e("footer.updateCacheText","更新缓存")})]}),h&&(0,r.jsxs)("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:[e("footer.lastUpdate","上次更新"),": ",h]})]})]}),(0,r.jsx)("div",{className:"mt-3 md:mt-4 pt-2 border-t border-gray-300 dark:border-white/10 text-center text-xs text-gray-600 dark:text-gray-300",children:(0,r.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," ",(0,r.jsx)("a",{className:"underline",href:"https://timepulse.ravelloh.top/",children:"TimePulse"})," by ",(0,r.jsx)("a",{className:"underline",href:"https://ravelloh.top/",children:"RavelloH"}),". ",e("footer.builtWith","使用 Next.js 和 Framer Motion 构建"),"。"]})})]})})}function j(){let{t:e}=(0,x.$)(),[t,a]=(0,n.useState)(!1),[s,l]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=e=>{e.detail.hasUpdates&&(a(!0),console.log("检测到应用更新，建议刷新页面"))};return window.addEventListener("cacheUpdatedWithChanges",e),()=>window.removeEventListener("cacheUpdatedWithChanges",e)},[]);let c=()=>{a(!1)};return(0,r.jsx)(o.M,{children:t&&(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[550] backdrop-blur-sm",onClick:c,children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-md m-4 p-6 rounded-2xl",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(d.Bw1,{className:"w-6 h-6 text-primary-500"})}),(0,r.jsx)("div",{children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e("updateToast.title","应用已更新")})})]}),(0,r.jsx)("button",{onClick:c,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:(0,r.jsx)(d.q5L,{className:"w-5 h-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"})})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:e("updateToast.message","发现新版本，建议刷新页面以获得最佳体验")})}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsxs)("button",{onClick:()=>{l(!0),setTimeout(()=>{window.location.reload()},500)},disabled:s,className:"flex-1 btn-glass-primary inline-flex items-center justify-center text-sm ".concat(s?"cursor-not-allowed opacity-60":""),children:[(0,r.jsx)(d.Bw1,{className:"w-4 h-4 mr-2 ".concat(s?"animate-spin":"")}),s?e("updateToast.refreshing","刷新中..."):e("updateToast.refresh","刷新")]}),(0,r.jsx)("button",{onClick:c,className:"flex-1 btn-glass-secondary inline-flex items-center justify-center text-sm",children:e("updateToast.later","稍后")})]})]})})})}function w(e){let{children:t}=e,{t:a}=(0,x.$)(),{scrollYProgress:s}=(0,l.v)(),o=(0,n.useRef)(null),[d,m]=(0,n.useState)(!1),[h,y]=(0,n.useState)(!1),g=(0,c.H)(s,[0,.4,.6,.8],[0,0,.5,1]),b=(0,c.H)(s,[.4,.8],[0,16]),p=(0,c.H)(s,[0,.2,.5,.8],[1,5,15,35]);return(0,n.useEffect)(()=>{let e=()=>{window.scrollY>10&&!h&&y(!0);let e=window.scrollY,t=window.innerHeight,a=document.documentElement.scrollHeight,r=e+t>=a-300;r&&!d?(m(!0),"#footer"!==window.location.hash&&(window.location.hash="footer")):!r&&d&&(m(!1),"#footer"===window.location.hash&&(window.location.hash=""))};return m(!1),window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[d,h]),(0,r.jsx)(u.S4,{children:(0,r.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,r.jsx)(f,{}),t,(0,r.jsx)(j,{}),(0,r.jsx)(i.E.div,{ref:o,style:{opacity:g,backdropFilter:"blur(".concat(b.get(),"px)"),zIndex:p,pointerEvents:d?"auto":"none"},className:"fixed inset-0 flex items-center justify-center overflow-y-auto",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(v,{})})}),!d&&!h&&(0,r.jsxs)(i.E.div,{className:"fixed bottom-24 left-0 right-0 mx-auto w-full text-center text-gray-400 text-sm pointer-events-none z-20",initial:{opacity:.6},animate:{opacity:[.6,1,.6],y:[0,10,0]},transition:{repeat:1/0,duration:2},children:[(0,r.jsx)("p",{children:a("footer.scrollDown","向下滑动查看更多信息")}),(0,r.jsx)("svg",{className:"w-6 h-6 mx-auto mt-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]}),(0,r.jsx)("div",{className:"h-screen"})]})})}function k(){let{getActiveTimer:e,activeTimerId:t}=(0,m.H)(),{theme:a}=(0,u.Fg)(),[s,l]=(0,n.useState)([]),[c,d]=(0,n.useState)(null);(0,n.useRef)(null);let x=e(),[h,y]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome"),t=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;y(e||t)},[]),(0,n.useEffect)(()=>{let e=t!==c;e&&d(t);let r=(null==x?void 0:x.color)||"#0ea5e9",n=g(r,"dark"===a);if(0===s.length||e){let e=Array.from({length:5},(e,t)=>({id:t,x:100*Math.random()-30+40*Math.random(),y:100*Math.random()-30+40*Math.random(),size:30+40*Math.random(),speedX:(Math.random()-.5)*(h?.01:.03),speedY:(Math.random()-.5)*(h?.01:.03),color:n[t%n.length],blur:h?40:60+40*Math.random(),opacity:.3+Math.random()*(h?.2:.3)}));l(e)}else x&&l(e=>e.map((e,t)=>({...e,color:n[t%n.length]})))},[t,a,x,h]);let g=(e,t)=>{let a,r,n;if(e.startsWith("#")){let t=e.slice(1);a=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),n=parseInt(t.slice(4,6),16)}else a=14,r=165,n=233;return["rgba(".concat(a,", ").concat(r,", ").concat(n,", 0.5)"),"rgba(".concat(.8*a,", ").concat(1.1*r,", ").concat(1.2*n,", 0.5)"),"rgba(".concat(1.2*a,", ").concat(.8*r,", ").concat(.9*n,", 0.5)"),"rgba(".concat(.9*a,", ").concat(.9*r,", ").concat(1.3*n,", 0.5)"),"rgba(".concat(1.1*a,", ").concat(1.2*r,", ").concat(.8*n,", 0.5)"),"rgba(".concat(1.3*a,", ").concat(.9*r,", ").concat(.9*n,", 0.5)")]};return(0,r.jsxs)("div",{className:"fixed inset-0 overflow-hidden z-0 pointer-events-none",children:[(0,r.jsx)(o.M,{children:s.map(e=>(0,r.jsx)(i.E.div,{className:"moving-circle absolute",initial:{left:"".concat(e.x,"vw"),top:"".concat(e.y,"vh"),width:"".concat(e.size,"vw"),height:"".concat(e.size,"vw"),opacity:0},animate:{left:["".concat(e.x,"vw"),"".concat(e.x+100*e.speedX,"vw")],top:["".concat(e.y,"vh"),"".concat(e.y+100*e.speedY,"vh")],backgroundColor:e.color,filter:"blur(".concat(e.blur,"px)"),opacity:e.opacity},transition:{left:{duration:h?30:20,ease:"linear",repeat:1/0,repeatType:"reverse"},top:{duration:h?30:20,ease:"linear",repeat:1/0,repeatType:"reverse"},backgroundColor:{duration:h?3.5:2.5,ease:"easeOut"},opacity:{duration:h?1.2:.8}},style:{WebkitTransform:"translateZ(0)",transform:"translateZ(0)",willChange:"transform"}},"circle-".concat(e.id,"-").concat(t||"default")))}),t!==c&&null!==c&&(0,r.jsx)(i.E.div,{className:"absolute inset-0 z-0 pointer-events-none",style:{background:"radial-gradient(circle at center, ".concat((null==x?void 0:x.color)||"#0ea5e9","05 0%, transparent 70%)")},initial:{opacity:0},animate:{opacity:.5},exit:{opacity:0},transition:{duration:2.5,ease:"easeOut"},onAnimationComplete:()=>d(t)})]})}function N(e){let{value:t,label:a,color:s="#0ea5e9"}=e,[l,c]=(0,n.useState)(t),[d,m]=(0,n.useState)(!1),[u,x]=(0,n.useState)(!1),h=(0,n.useRef)({timer:null,isAnimating:!1,lastValue:t});(0,n.useEffect)(()=>{let e=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome"),t=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;x(e||t)},[]);let y=()=>{h.current.timer&&(clearTimeout(h.current.timer),h.current.timer=null),c(t),m(!1),h.current.isAnimating=!1,h.current.lastValue=t};return(0,n.useEffect)(()=>{let e=()=>{"visible"===document.visibilityState&&y()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[t]),(0,n.useEffect)(()=>{if(t===h.current.lastValue)return;h.current.lastValue=t,h.current.timer&&clearTimeout(h.current.timer),h.current.isAnimating?(y(),requestAnimationFrame(()=>{c(t),m(!0),h.current.isAnimating=!0})):(c(l),m(!0),h.current.isAnimating=!0);let e=u?200:300;return h.current.timer=setTimeout(()=>{c(t),m(!1),h.current.isAnimating=!1,h.current.timer=null},e),()=>{h.current.timer&&clearTimeout(h.current.timer)}},[t,l,u]),(0,n.useEffect)(()=>()=>{h.current.timer&&clearTimeout(h.current.timer)},[]),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(i.E.div,{className:"".concat((()=>{let e=t.toString().length;return e>=3?"w-24 sm:w-32 md:w-40":2===e?"w-20 sm:w-24 md:w-32":"w-16 sm:w-20 md:w-24"})()," h-24 sm:h-32 md:h-36 rounded-xl glass-card flex items-center justify-center relative overflow-hidden"),style:{boxShadow:"0 0 30px ".concat(s,"20"),transition:"box-shadow 0.5s var(--transition-timing)",transform:"translateZ(0)",WebkitTransform:"translateZ(0)",willChange:"transform"},whileHover:{boxShadow:"0 0 40px ".concat(s,"40"),scale:1.02},transition:{duration:.3},children:(0,r.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,r.jsx)(o.M,{mode:"wait",children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.E.span,{initial:{y:0,opacity:1},animate:{y:"-100%",opacity:0},exit:{y:"-100%",opacity:0},transition:{duration:u?.2:.3,ease:"easeInOut"},className:"absolute text-5xl sm:text-6xl md:text-7xl font-bold",style:{color:s,transform:"translateZ(0)",WebkitTransform:"translateZ(0)",willChange:"transform"},children:l},"prev-".concat(l,"-").concat(Date.now())),(0,r.jsx)(i.E.span,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},transition:{duration:u?.2:.3,ease:"easeInOut"},className:"absolute text-5xl sm:text-6xl md:text-7xl font-bold",style:{color:s,transform:"translateZ(0)",WebkitTransform:"translateZ(0)",willChange:"transform"},children:t},"current-".concat(t,"-").concat(Date.now()))]}):(0,r.jsx)(i.E.span,{className:"text-5xl sm:text-6xl md:text-7xl font-bold",style:{color:s,transform:"translateZ(0)",WebkitTransform:"translateZ(0)"},children:t},"static-".concat(t,"-").concat(h.current.isAnimating?Date.now():"stable"))})})}),(0,r.jsx)(i.E.span,{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",whileHover:{color:s},transition:{duration:.3},children:a})]})}var C=a(5757);function z(){let{getActiveTimer:e,updateTimer:t,checkAndUpdateDefaultTimer:a}=(0,m.H)(),{t:s}=(0,x.$)(),[l,c]=(0,n.useState)({days:0,hours:0,minutes:0,seconds:0}),[u,h]=(0,n.useState)(!0),[y,g]=(0,n.useState)(!1),[b,p]=(0,n.useState)(!1),f=(0,n.useRef)({days:0,hours:0,minutes:0,seconds:0}),v=(0,n.useRef)(null),j=(0,n.useRef)(null);(0,n.useRef)(null);let w=(0,n.useRef)(0),k=(0,n.useRef)(-1),z=(e,t)=>e.days===t.days&&e.hours===t.hours&&e.minutes===t.minutes&&e.seconds===t.seconds,E=()=>{if(j.current&&clearInterval(j.current),v.current&&clearInterval(v.current),"visible"!==document.visibilityState)return;let t=new Date;k.current=t.getSeconds(),j.current=setInterval(()=>{if("visible"!==document.visibilityState){clearInterval(j.current),clearInterval(v.current);return}let t=new Date,a=t.getSeconds();if(a!==k.current){k.current=a,clearInterval(j.current);let t=e();t&&S(t),v.current=setInterval(()=>{let t=e();t&&"visible"===document.visibilityState&&S(t)},1e3)}},1)},S=e=>{if("visible"===document.visibilityState)switch(e.type){case"stopwatch":T(e);break;case"worldclock":D(e);break;default:F(e)}},A=(e,t)=>e.days===t.days&&e.hours===t.hours&&e.minutes===t.minutes&&e.seconds!==t.seconds,F=e=>{let t=new Date,r=new Date(e.targetDate),n=r-t;if(n<=0){if(!y){g(!0),c({days:0,hours:0,minutes:0,seconds:0}),f.current={days:0,hours:0,minutes:0,seconds:0},a&&a();try{console.log("倒计时结束，尝试发送通知:",e.name),(0,C.wN)({id:e.id,title:e.name,targetTime:Date.now()}).catch(e=>{console.error("发送倒计时结束通知失败:",e)})}catch(e){console.error("发送倒计时结束通知失败:",e)}}return}y&&g(!1);let s=Math.floor(n/864e5),i={days:s,hours:Math.floor(n/36e5%24),minutes:Math.floor(n/1e3/60%60),seconds:Math.floor(n/1e3%60)};z(i,f.current)||(c(i),f.current=i,h(s>0))},T=e=>{let t=new Date,a=new Date(e.startTime),r=0;if(e.isRunning)r=t-a-(e.totalPausedTime||0);else if(e.pausedAt){let t=new Date(e.pausedAt);r=t-a-(e.totalPausedTime||0)}else r=0;r=Math.max(0,r);let n=Math.floor(r/1e3),s=Math.floor(n/86400),i=n%60,o={days:s,hours:Math.floor(n%86400/3600),minutes:Math.floor(n%3600/60),seconds:i};z(o,f.current)||("stopwatch"===e.type&&A(o,f.current)?c(e=>({...e,seconds:i})):c(o),f.current=o,h(s>0))},D=e=>{let t=new Date,a=new Date(t.toLocaleString("en-US",{timeZone:e.timezone})),r=a.getHours(),n=a.getMinutes(),s=a.getSeconds(),i={days:0,hours:r,minutes:n,seconds:s};z(i,f.current)||(c(i),f.current=i,h(!1))};(0,n.useEffect)(()=>{v.current&&clearInterval(v.current),j.current&&clearInterval(j.current);let t=e();if(!t)return;"stopwatch"===t.type&&(p(!0===t.isRunning),w.current=t.totalPausedTime||0),S(t),E();let a=()=>{if("visible"===document.visibilityState){let t=e();t&&(S(t),E())}};return document.addEventListener("visibilitychange",a),()=>{clearInterval(v.current),clearInterval(j.current),document.removeEventListener("visibilitychange",a)}},[e,y,a,b]);let L=a=>{let r=e();if(!r||"stopwatch"!==r.type)return;let n=new Date;switch(a){case"play":if(r.pausedAt){let e=n-new Date(r.pausedAt),a=(r.totalPausedTime||0)+e;t(r.id,{isRunning:!0,pausedAt:null,totalPausedTime:a})}else t(r.id,{isRunning:!0,startTime:r.startTime||n.toISOString(),pausedAt:null,totalPausedTime:r.totalPausedTime||0});p(!0);break;case"pause":t(r.id,{isRunning:!1,pausedAt:n.toISOString()}),p(!1);break;case"stop":t(r.id,{isRunning:!1,startTime:n.toISOString(),pausedAt:null,totalPausedTime:0}),p(!1),c({days:0,hours:0,minutes:0,seconds:0}),f.current={days:0,hours:0,minutes:0,seconds:0}}},I=e=>e.toString().padStart(2,"0"),P=e();return P?(0,r.jsxs)(i.E.div,{className:"flex flex-col items-center justify-center text-center px-4 relative z-10",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,r.jsx)(i.E.h2,{className:"text-xl sm:text-2xl md:text-3xl font-medium mb-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},style:{color:P.color,transition:"color 0.3s var(--transition-timing)"},children:(P.type,P.name)}),(0,r.jsxs)(i.E.div,{className:"flex items-center justify-center space-x-2 sm:space-x-4",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:[u&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N,{value:I(l.days),label:s("time.days"),color:P.color||"#0ea5e9"}),(0,r.jsx)("span",{className:"text-4xl sm:text-5xl md:text-6xl font-thin text-gray-400",children:":"})]}),(0,r.jsx)(N,{value:I(l.hours),label:s("time.hours"),color:P.color||"#0ea5e9"}),(0,r.jsx)("span",{className:"text-4xl sm:text-5xl md:text-6xl font-thin text-gray-400",children:":"}),(0,r.jsx)(N,{value:I(l.minutes),label:s("time.minutes"),color:P.color||"#0ea5e9"}),(0,r.jsx)("span",{className:"text-4xl sm:text-5xl md:text-6xl font-thin text-gray-400",children:":"}),(0,r.jsx)(N,{value:I(l.seconds),label:s("time.seconds"),color:P.color||"#0ea5e9"})]}),"stopwatch"===P.type&&(0,r.jsxs)(i.E.div,{className:"mt-8 flex space-x-4 relative",style:{zIndex:40,pointerEvents:"auto"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[(0,r.jsx)("button",{onClick:()=>L(b?"pause":"play"),className:"glass-card p-4 rounded-full hover:bg-white/10 dark:hover:bg-black/10 transition-colors cursor-pointer select-none",style:{color:P.color,zIndex:41,position:"relative",pointerEvents:"auto",userSelect:"none"},children:b?(0,r.jsx)(d.R4s,{className:"text-xl pointer-events-none"}):(0,r.jsx)(d.KCr,{className:"text-xl pointer-events-none"})}),(0,r.jsx)("button",{onClick:()=>L("stop"),className:"glass-card p-4 rounded-full hover:bg-white/10 dark:hover:bg-black/10 transition-colors cursor-pointer select-none",style:{color:P.color,zIndex:41,position:"relative",pointerEvents:"auto",userSelect:"none"},children:(0,r.jsx)(d.jxP,{className:"text-xl pointer-events-none"})})]}),(0,r.jsx)(o.M,{children:y&&"countdown"===P.type&&(0,r.jsx)(i.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"mt-8 glass-card px-6 py-4 rounded-xl",children:(0,r.jsx)("p",{className:"text-lg font-medium text-gray-800 dark:text-gray-200",children:s("timer.finished")})})}),(0,r.jsx)(i.E.p,{className:"mt-6 text-sm text-gray-500 dark:text-gray-400",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:(()=>{switch(P.type){case"stopwatch":return b?s("timer.running"):s("timer.paused");case"worldclock":return"".concat(P.country," - ").concat(P.timezone);default:return"".concat(s("timer.target"),": ").concat(new Date(P.targetDate).toLocaleString())}})()})]},P.id):(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("p",{className:"text-xl text-gray-400",children:s("timer.noActiveTimer")})})}function E(e){let{name:t,value:a,onChange:s,options:l,placeholder:c,label:m,icon:h,className:y="",disabled:g=!1,required:b=!1}=e,{accentColor:p}=(0,u.Fg)(),{t:f}=(0,x.$)(),[v,j]=(0,n.useState)(!1),[w,k]=(0,n.useState)(""),N=(0,n.useRef)(null),C=c||f("common.select","请选择");(0,n.useEffect)(()=>{if(a){let e=l.find(e=>e.value===a);e&&k(e.label)}else k("")},[a,l]),(0,n.useEffect)(()=>{let e=e=>{N.current&&!N.current.contains(e.target)&&j(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,n.useEffect)(()=>{let e=e=>{if(v){if("Escape"===e.key)j(!1);else if("ArrowDown"===e.key||"ArrowUp"===e.key){let t;e.preventDefault();let r=l.findIndex(e=>e.value===a);t="ArrowDown"===e.key?r<l.length-1?r+1:0:r>0?r-1:l.length-1;let n=l[t];z(n.value,n.label)}}};return v&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[v,l,a]);let z=(e,a)=>{k(a),s({target:{name:t,value:e}}),j(!1)};return(0,r.jsxs)("div",{className:"relative ".concat(y),ref:N,children:[m&&(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1",children:[m,b&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 rounded-lg \n          bg-white/10 dark:bg-black/10 backdrop-blur-sm border \n          ".concat(v?"border-primary-400 dark:border-primary-500":"border-white/20 dark:border-white/10"," \n          cursor-pointer transition-all duration-200 ").concat(g?"opacity-60 cursor-not-allowed":"hover:bg-white/20 dark:hover:bg-black/20"),onClick:()=>!g&&j(!v),role:"combobox","aria-expanded":v,"aria-haspopup":"listbox","aria-controls":"select-dropdown-".concat(t),"aria-disabled":g,tabIndex:g?-1:0,onKeyDown:e=>{g||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),j(!v))},style:{boxShadow:v?"0 0 0 2px ".concat(p,"40"):"none"},children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 truncate",children:[h&&(0,r.jsx)(h,{className:"text-gray-500 dark:text-gray-400"}),(0,r.jsx)("span",{className:w?"text-gray-800 dark:text-gray-100":"text-gray-500 dark:text-gray-400",children:w||C})]}),(0,r.jsx)(d.bTu,{className:"transition-transform duration-200 ".concat(v?"transform rotate-180":""),style:{color:v?p:"currentColor"}})]}),(0,r.jsx)(o.M,{children:v&&(0,r.jsx)(i.E.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.15,ease:"easeOut"},className:"absolute z-50 w-full mt-1 glass-card rounded-lg shadow-lg overflow-hidden max-h-60 overflow-y-auto",id:"select-dropdown-".concat(t),role:"listbox",style:{backgroundColor:"rgba(var(--color-background), 0.7)",borderColor:"rgba(var(--color-primary), 0.2)",backdropFilter:"blur(8px)"},children:l.map(e=>(0,r.jsxs)("div",{className:"px-4 py-2 cursor-pointer flex items-center justify-between transition-colors duration-150\n                  ".concat(a===e.value?"text-white font-medium":"text-gray-800 dark:text-gray-100 hover:bg-white/10 dark:hover:bg-black/20"),onClick:()=>z(e.value,e.label),role:"option","aria-selected":a===e.value,tabIndex:0,onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),z(e.value,e.label))},style:a===e.value?{background:"linear-gradient(90deg, ".concat(p,"99, ").concat(p,"40)")}:{},children:[(0,r.jsx)("span",{children:e.label}),a===e.value&&(0,r.jsx)(d.UgA,{className:"text-white"})]},e.value))})}),(0,r.jsxs)("select",{name:t,value:a,onChange:s,className:"sr-only","aria-hidden":"true",tabIndex:-1,required:b,disabled:g,children:[(0,r.jsx)("option",{value:"",disabled:!0,children:C}),l.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))]})]})}let S=[{timezone:"Asia/Shanghai",city:"上海",country:"中国"},{timezone:"Asia/Hong_Kong",city:"香港",country:"中国"},{timezone:"Asia/Taipei",city:"台北",country:"台湾"},{timezone:"Asia/Tokyo",city:"东京",country:"日本"},{timezone:"Asia/Seoul",city:"首尔",country:"韩国"},{timezone:"Asia/Singapore",city:"新加坡",country:"新加坡"},{timezone:"Asia/Bangkok",city:"曼谷",country:"泰国"},{timezone:"Asia/Kuala_Lumpur",city:"吉隆坡",country:"马来西亚"},{timezone:"Asia/Jakarta",city:"雅加达",country:"印尼"},{timezone:"Asia/Manila",city:"马尼拉",country:"菲律宾"},{timezone:"Asia/Kolkata",city:"新德里",country:"印度"},{timezone:"Asia/Dubai",city:"迪拜",country:"阿联酋"},{timezone:"Asia/Riyadh",city:"利雅得",country:"沙特"},{timezone:"Asia/Tehran",city:"德黑兰",country:"伊朗"},{timezone:"Asia/Tashkent",city:"塔什干",country:"乌兹别克斯坦"},{timezone:"Europe/London",city:"伦敦",country:"英国"},{timezone:"Europe/Paris",city:"巴黎",country:"法国"},{timezone:"Europe/Berlin",city:"柏林",country:"德国"},{timezone:"Europe/Rome",city:"罗马",country:"意大利"},{timezone:"Europe/Madrid",city:"马德里",country:"西班牙"},{timezone:"Europe/Amsterdam",city:"阿姆斯特丹",country:"荷兰"},{timezone:"Europe/Brussels",city:"布鲁塞尔",country:"比利时"},{timezone:"Europe/Vienna",city:"维也纳",country:"奥地利"},{timezone:"Europe/Zurich",city:"苏黎世",country:"瑞士"},{timezone:"Europe/Stockholm",city:"斯德哥尔摩",country:"瑞典"},{timezone:"Europe/Oslo",city:"奥斯陆",country:"挪威"},{timezone:"Europe/Helsinki",city:"赫尔辛基",country:"芬兰"},{timezone:"Europe/Moscow",city:"莫斯科",country:"俄罗斯"},{timezone:"Europe/Athens",city:"雅典",country:"希腊"},{timezone:"Europe/Istanbul",city:"伊斯坦布尔",country:"土耳其"},{timezone:"America/New_York",city:"纽约",country:"美国"},{timezone:"America/Los_Angeles",city:"洛杉矶",country:"美国"},{timezone:"America/Chicago",city:"芝加哥",country:"美国"},{timezone:"America/Denver",city:"丹佛",country:"美国"},{timezone:"America/Phoenix",city:"凤凰城",country:"美国"},{timezone:"America/Anchorage",city:"安克雷奇",country:"美国"},{timezone:"Pacific/Honolulu",city:"火奴鲁鲁",country:"美国"},{timezone:"America/Toronto",city:"多伦多",country:"加拿大"},{timezone:"America/Vancouver",city:"温哥华",country:"加拿大"},{timezone:"America/Mexico_City",city:"墨西哥城",country:"墨西哥"},{timezone:"America/Sao_Paulo",city:"圣保罗",country:"巴西"},{timezone:"America/Argentina/Buenos_Aires",city:"布宜诺斯艾利斯",country:"阿根廷"},{timezone:"America/Lima",city:"利马",country:"秘鲁"},{timezone:"America/Bogota",city:"波哥大",country:"哥伦比亚"},{timezone:"America/Caracas",city:"加拉加斯",country:"委内瑞拉"},{timezone:"Australia/Sydney",city:"悉尼",country:"澳大利亚"},{timezone:"Australia/Melbourne",city:"墨尔本",country:"澳大利亚"},{timezone:"Australia/Perth",city:"珀斯",country:"澳大利亚"},{timezone:"Pacific/Auckland",city:"奥克兰",country:"新西兰"},{timezone:"Pacific/Fiji",city:"苏瓦",country:"斐济"},{timezone:"Africa/Cairo",city:"开罗",country:"埃及"},{timezone:"Africa/Johannesburg",city:"约翰内斯堡",country:"南非"},{timezone:"Africa/Lagos",city:"拉各斯",country:"尼日利亚"},{timezone:"Africa/Nairobi",city:"内罗毕",country:"肯尼亚"},{timezone:"Africa/Casablanca",city:"卡萨布兰卡",country:"摩洛哥"}];function A(e){let{onClose:t,onSelectTimezone:a,title:s="选择时区"}=e,{t:o}=(0,x.$)(),[l,c]=(0,n.useState)(""),m=(e,t)=>{let a="timezone.".concat(t.replace(/\//g,"_").replace(/\-/g,"_"));return o(a,e)},u=(e,t)=>{let a="country.".concat(e);return o(a,e)},h=S.filter(e=>{let t=m(e.city,e.timezone),a=u(e.country,e.timezone),r=l.toLowerCase();return t.toLowerCase().includes(r)||a.toLowerCase().includes(r)||e.city.toLowerCase().includes(r)||e.country.toLowerCase().includes(r)||e.timezone.toLowerCase().includes(r)}),y=e=>{a(e.timezone,e.city,e.country)};return(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm overflow-y-auto py-4",onClick:t,children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-2xl m-4 p-6 rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:s}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.jRj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:o("modal.timezone.search","搜索城市或国家..."),value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"})]})}),(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto overflow-x-hidden",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:h.map((e,t)=>{let a=m(e.city,e.timezone),n=u(e.country,e.timezone);return(0,r.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-3 rounded-lg hover:bg-white/10 dark:hover:bg-black/10 transition-colors text-left flex items-center space-x-3 min-w-0",onClick:()=>y(e),"data-umami-event":"选择时区-".concat(a),children:[(0,r.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center",children:(0,r.jsx)(d.i63,{className:"text-blue-500 text-sm"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"font-medium truncate",children:a}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:[n," - ",e.timezone]})]})]},t)})})}),(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:t,children:o("common.cancel","取消")})})]})})}let F=["#FF4D4F","#FA8C16","#FAAD14","#52C41A","#13C2C2","#1890FF","#722ED1","#EB2F96","#F759AB","#FF7A45","#FFC53D","#BFBFBF","#69C0FF","#95DE64","#FF9C6E","#B37FEB","#5CDBD3","#FF85C0","#FFC069","#85A5FF"];function T(e){let{onClose:t}=e,{addTimer:a,holidaysList:s}=(0,m.H)(),{accentColor:o}=(0,u.Fg)(),{t:l}=(0,x.$)(),[c,h]=(0,n.useState)(!1),[y,g]=(0,n.useState)(!1),[b,f]=(0,n.useState)(!1),[v,j]=(0,n.useState)(1),w=F[Math.floor(Math.random()*F.length)],[k,N]=(0,n.useState)({name:"",targetDate:new Date(Date.now()+864e5).toISOString().slice(0,10),targetTime:"00:00",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,color:w}),C=e=>{let{name:t,value:a}=e.target;N(e=>({...e,[t]:a}))},z=e=>{N(t=>({...t,color:e}))},E=e=>{let t=new Date(e.date);N({name:e.name,targetDate:t.toISOString().slice(0,10),targetTime:t.toTimeString().slice(0,5),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,color:e.color}),g(!1)};return(0,r.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm overflow-y-auto py-4",onClick:t,children:[(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-md m-4 p-6 rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[1===v&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:l("modal.countdown.create","创建倒计时")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("button",{className:"w-full glass-card p-4 mb-4 text-left flex items-center hover:bg-white/10 dark:hover:bg-black/10",onClick:()=>g(!y),"data-umami-event":"查看节假日列表",children:[(0,r.jsx)(d.vlc,{className:"mr-2 text-primary-500"}),(0,r.jsx)("span",{children:l("modal.countdown.selectHoliday","选择常用节假日")})]}),y&&(0,r.jsx)("div",{className:"bg-white/10 dark:bg-black/10 rounded-xl p-3 mb-4 max-h-60 overflow-y-auto",children:s.map((e,t)=>(0,r.jsxs)("button",{className:"w-full p-2 mb-2 rounded-lg flex items-center justify-between hover:bg-white/20 dark:hover:bg-black/20 transition-colors",onClick:()=>E(e),"data-umami-event":"选择节假日-".concat(e.name),children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsx)("span",{className:"w-4 h-4 rounded-full",style:{backgroundColor:e.color}})]},t))})]}),(0,r.jsxs)("form",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("modal.countdown.name","计时器名称")}),(0,r.jsx)("input",{type:"text",name:"name",value:k.name,onChange:C,placeholder:l("modal.countdown.namePlaceholder","例如: 春节倒计时"),className:"w-full px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("modal.countdown.date","目标日期")}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"absolute pl-3 text-gray-500 z-10",children:(0,r.jsx)(d.vlc,{})}),(0,r.jsx)("input",{type:"date",name:"targetDate",value:k.targetDate,onChange:C,className:"w-full pl-10 pr-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("modal.countdown.time","目标时间")}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"absolute pl-3 text-gray-500 z-10",children:(0,r.jsx)(d.TCC,{})}),(0,r.jsx)("input",{type:"time",name:"targetTime",value:k.targetTime,onChange:C,className:"w-full pl-10 pr-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:l("modal.timezone.title","时区")}),(0,r.jsx)("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 hover:bg-white/20 dark:hover:bg-black/20 transition-colors",onClick:()=>f(!0),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.RsK,{className:"mr-2 text-gray-400"}),(0,r.jsx)("span",{className:"text-sm",children:"Asia/Shanghai"===k.timezone?l("modal.timezone.chinaTime","中国标准时间 (UTC+8)"):"America/New_York"===k.timezone?l("modal.timezone.eastTime","美国东部时间"):"Europe/London"===k.timezone?l("modal.timezone.ukTime","英国时间"):"Europe/Paris"===k.timezone?l("modal.timezone.centralEuropeTime","欧洲中部时间"):"Asia/Tokyo"===k.timezone?l("modal.timezone.japanTime","日本时间"):k.timezone})]})})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:t,children:l("common.cancel","取消")}),(0,r.jsx)("button",{className:"btn-glass-primary",onClick:()=>j(2),disabled:!k.name||!k.targetDate||!k.targetTime,"data-umami-event":"下一步-选择颜色",children:l("common.next","下一步")})]})]}),2===v&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:l("modal.countdown.selectColor","选择颜色")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsx)("div",{className:"flex justify-center mb-6",children:(0,r.jsx)("div",{className:"w-24 h-24 rounded-full",style:{backgroundColor:k.color}})}),(0,r.jsx)(p.gW,{color:k.color,onChange:z,className:"w-full mb-6"}),(0,r.jsx)("div",{className:"grid grid-cols-5 gap-2 mb-6",children:F.slice(0,20).map(e=>(0,r.jsx)("button",{className:"w-full aspect-square rounded-full ".concat(k.color===e?"ring-2 ring-white":""),style:{backgroundColor:e},onClick:()=>z(e),"data-umami-event":"选择预设颜色-".concat(e)},e))}),(0,r.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:()=>j(1),children:l("common.previous","上一步")}),(0,r.jsx)("button",{className:"btn-glass-primary",onClick:()=>{let e=new Date("".concat(k.targetDate,"T").concat(k.targetTime)),r={name:k.name,type:"countdown",targetDate:e.toISOString(),timezone:k.timezone,color:k.color};a(r),j(3),setTimeout(()=>{t()},2e3)},"data-umami-event":"创建计时器-确认",children:l("common.create","创建")})]})]}),3===v&&(0,r.jsxs)("div",{className:"py-8 text-center",children:[(0,r.jsx)(i.E.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"w-16 h-16 mx-auto mb-4 rounded-full bg-green-500 flex items-center justify-center",children:(0,r.jsx)(d.UgA,{className:"text-white text-3xl"})}),(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:l("modal.countdown.created","倒计时已创建")}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:l("modal.countdown.createdDesc","您的倒计时已成功创建")})]})]}),b&&(0,r.jsx)(A,{onClose:()=>f(!1),onSelectTimezone:(e,t,a)=>{N(t=>({...t,timezone:e})),f(!1)},title:l("modal.timezone.title","选择时区")})]})}let D=["#52C41A","#1890FF","#722ED1","#13C2C2","#FA8C16","#FAAD14","#F759AB","#FF7A45","#95DE64","#69C0FF","#B37FEB","#5CDBD3","#FFC069","#85A5FF","#FF9C6E","#FF85C0","#36CFC9","#FFC53D","#BFBFBF","#2F54EB"];function L(e){let{onClose:t}=e,{addTimer:a}=(0,m.H)(),{accentColor:s}=(0,u.Fg)(),{t:o}=(0,x.$)(),[l,c]=(0,n.useState)(1),h=D[Math.floor(3*Math.random())],[y,g]=(0,n.useState)({name:"",color:h}),b=e=>{g(t=>({...t,color:e}))};return(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm overflow-y-auto py-4",onClick:t,children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-md m-4 p-6 rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[1===l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:o("modal.addStopwatch.create","创建正计时")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsxs)("form",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:o("modal.addStopwatch.timerName","计时器名称")}),(0,r.jsx)("input",{type:"text",name:"name",value:y.name,onChange:e=>{let{name:t,value:a}=e.target;g(e=>({...e,[t]:a}))},placeholder:o("modal.addStopwatch.namePlaceholder","例如: 学习时间"),className:"w-full px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none",required:!0})]}),(0,r.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-medium text-green-800 dark:text-green-200 mb-2",children:o("modal.addStopwatch.description","正计时说明")}),(0,r.jsx)("p",{className:"text-sm text-green-600 dark:text-green-300",children:o("modal.addStopwatch.descriptionText","正计时将从零开始计算经过的时间，创建后会立即开始计时。您可以随时暂停和恢复计时。")})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:t,children:o("common.cancel","取消")}),(0,r.jsx)("button",{className:"btn-glass-primary",onClick:()=>c(2),disabled:!y.name,"data-umami-event":"下一步-选择正计时颜色",children:o("common.next","下一步")})]})]}),2===l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:o("modal.addStopwatch.selectColor","选择颜色")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsx)("div",{className:"flex justify-center mb-6",children:(0,r.jsx)("div",{className:"w-24 h-24 rounded-full",style:{backgroundColor:y.color}})}),(0,r.jsx)(p.gW,{color:y.color,onChange:b,className:"w-full mb-6"}),(0,r.jsx)("div",{className:"grid grid-cols-5 gap-2 mb-6",children:D.map(e=>(0,r.jsx)("button",{className:"w-full aspect-square rounded-full ".concat(y.color===e?"ring-2 ring-white":""),style:{backgroundColor:e},onClick:()=>b(e),"data-umami-event":"选择正计时预设颜色-".concat(e)},e))}),(0,r.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:()=>c(1),children:o("common.previous","上一步")}),(0,r.jsx)("button",{className:"btn-glass-primary",onClick:()=>{let e={name:y.name,type:"stopwatch",startTime:new Date().toISOString(),color:y.color,isRunning:!0};a(e),c(3),setTimeout(()=>{t()},2e3)},"data-umami-event":"创建正计时-确认",children:o("modal.addStopwatch.createAndStart","创建并开始")})]})]}),3===l&&(0,r.jsxs)("div",{className:"py-8 text-center",children:[(0,r.jsx)(i.E.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"w-16 h-16 mx-auto mb-4 rounded-full bg-green-500 flex items-center justify-center",children:(0,r.jsx)(d.UgA,{className:"text-white text-3xl"})}),(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:o("timer.stopwatchCreated","正计时已创建")}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:o("timer.stopwatchStarted","正计时已开始运行")})]})]})})}let I=[{id:"beijing",name:"北京",timezone:"Asia/Shanghai",country:"中国",color:"#FF0000"},{id:"tokyo",name:"东京",timezone:"Asia/Tokyo",country:"日本",color:"#FF6B6B"},{id:"seoul",name:"首尔",timezone:"Asia/Seoul",country:"韩国",color:"#4ECDC4"},{id:"singapore",name:"新加坡",timezone:"Asia/Singapore",country:"新加坡",color:"#FF4757"},{id:"bangkok",name:"曼谷",timezone:"Asia/Bangkok",country:"泰国",color:"#FFD700"},{id:"mumbai",name:"孟买",timezone:"Asia/Kolkata",country:"印度",color:"#FF9500"},{id:"dubai",name:"迪拜",timezone:"Asia/Dubai",country:"阿联酋",color:"#00B894"},{id:"moscow",name:"莫斯科",timezone:"Europe/Moscow",country:"俄罗斯",color:"#0984E3"},{id:"london",name:"伦敦",timezone:"Europe/London",country:"英国",color:"#8B4513"},{id:"paris",name:"巴黎",timezone:"Europe/Paris",country:"法国",color:"#6C5CE7"},{id:"berlin",name:"柏林",timezone:"Europe/Berlin",country:"德国",color:"#FD79A8"},{id:"rome",name:"罗马",timezone:"Europe/Rome",country:"意大利",color:"#00B894"},{id:"newyork",name:"纽约",timezone:"America/New_York",country:"美国",color:"#0984E3"},{id:"losangeles",name:"洛杉矶",timezone:"America/Los_Angeles",country:"美国",color:"#FDCB6E"},{id:"chicago",name:"芝加哥",timezone:"America/Chicago",country:"美国",color:"#E17055"},{id:"toronto",name:"多伦多",timezone:"America/Toronto",country:"加拿大",color:"#FF0000"},{id:"vancouver",name:"温哥华",timezone:"America/Vancouver",country:"加拿大",color:"#00B894"},{id:"sydney",name:"悉尼",timezone:"Australia/Sydney",country:"澳大利亚",color:"#0984E3"},{id:"melbourne",name:"墨尔本",timezone:"Australia/Melbourne",country:"澳大利亚",color:"#6C5CE7"},{id:"auckland",name:"奥克兰",timezone:"Pacific/Auckland",country:"新西兰",color:"#00CEC9"}],P=[{timezone:"Asia/Shanghai",city:"上海",country:"中国"},{timezone:"Asia/Hong_Kong",city:"香港",country:"中国"},{timezone:"Asia/Taipei",city:"台北",country:"台湾"},{timezone:"Asia/Tokyo",city:"东京",country:"日本"},{timezone:"Asia/Seoul",city:"首尔",country:"韩国"},{timezone:"Asia/Singapore",city:"新加坡",country:"新加坡"},{timezone:"Asia/Bangkok",city:"曼谷",country:"泰国"},{timezone:"Asia/Kuala_Lumpur",city:"吉隆坡",country:"马来西亚"},{timezone:"Asia/Jakarta",city:"雅加达",country:"印尼"},{timezone:"Asia/Manila",city:"马尼拉",country:"菲律宾"},{timezone:"Asia/Kolkata",city:"新德里",country:"印度"},{timezone:"Asia/Dubai",city:"迪拜",country:"阿联酋"},{timezone:"Asia/Riyadh",city:"利雅得",country:"沙特"},{timezone:"Asia/Tehran",city:"德黑兰",country:"伊朗"},{timezone:"Asia/Tashkent",city:"塔什干",country:"乌兹别克斯坦"},{timezone:"Europe/London",city:"伦敦",country:"英国"},{timezone:"Europe/Paris",city:"巴黎",country:"法国"},{timezone:"Europe/Berlin",city:"柏林",country:"德国"},{timezone:"Europe/Rome",city:"罗马",country:"意大利"},{timezone:"Europe/Madrid",city:"马德里",country:"西班牙"},{timezone:"Europe/Amsterdam",city:"阿姆斯特丹",country:"荷兰"},{timezone:"Europe/Brussels",city:"布鲁塞尔",country:"比利时"},{timezone:"Europe/Vienna",city:"维也纳",country:"奥地利"},{timezone:"Europe/Zurich",city:"苏黎世",country:"瑞士"},{timezone:"Europe/Stockholm",city:"斯德哥尔摩",country:"瑞典"},{timezone:"Europe/Oslo",city:"奥斯陆",country:"挪威"},{timezone:"Europe/Helsinki",city:"赫尔辛基",country:"芬兰"},{timezone:"Europe/Moscow",city:"莫斯科",country:"俄罗斯"},{timezone:"Europe/Athens",city:"雅典",country:"希腊"},{timezone:"Europe/Istanbul",city:"伊斯坦布尔",country:"土耳其"},{timezone:"America/New_York",city:"纽约",country:"美国"},{timezone:"America/Los_Angeles",city:"洛杉矶",country:"美国"},{timezone:"America/Chicago",city:"芝加哥",country:"美国"},{timezone:"America/Denver",city:"丹佛",country:"美国"},{timezone:"America/Phoenix",city:"凤凰城",country:"美国"},{timezone:"America/Anchorage",city:"安克雷奇",country:"美国"},{timezone:"Pacific/Honolulu",city:"火奴鲁鲁",country:"美国"},{timezone:"America/Toronto",city:"多伦多",country:"加拿大"},{timezone:"America/Vancouver",city:"温哥华",country:"加拿大"},{timezone:"America/Mexico_City",city:"墨西哥城",country:"墨西哥"},{timezone:"America/Sao_Paulo",city:"圣保罗",country:"巴西"},{timezone:"America/Argentina/Buenos_Aires",city:"布宜诺斯艾利斯",country:"阿根廷"},{timezone:"America/Lima",city:"利马",country:"秘鲁"},{timezone:"America/Bogota",city:"波哥大",country:"哥伦比亚"},{timezone:"America/Caracas",city:"加拉加斯",country:"委内瑞拉"},{timezone:"Australia/Sydney",city:"悉尼",country:"澳大利亚"},{timezone:"Australia/Melbourne",city:"墨尔本",country:"澳大利亚"},{timezone:"Australia/Perth",city:"珀斯",country:"澳大利亚"},{timezone:"Pacific/Auckland",city:"奥克兰",country:"新西兰"},{timezone:"Pacific/Fiji",city:"苏瓦",country:"斐济"},{timezone:"Africa/Cairo",city:"开罗",country:"埃及"},{timezone:"Africa/Johannesburg",city:"约翰内斯堡",country:"南非"},{timezone:"Africa/Lagos",city:"拉各斯",country:"尼日利亚"},{timezone:"Africa/Nairobi",city:"内罗毕",country:"肯尼亚"},{timezone:"Africa/Casablanca",city:"卡萨布兰卡",country:"摩洛哥"}];function M(e){let{onClose:t,onSelectWorldClock:a}=e,{t:s}=(0,x.$)(),[o,l]=(0,n.useState)(""),[c,m]=(0,n.useState)(!1),u=(e,t)=>{let a="timezone.".concat(t.replace(/\//g,"_").replace(/\-/g,"_"));return s(a,e)},h=e=>{let t="country.".concat(e);return s(t,e)},y=P.filter(e=>{let t=u(e.city,e.timezone),a=h(e.country),r=o.toLowerCase();return t.toLowerCase().includes(r)||a.toLowerCase().includes(r)||e.city.toLowerCase().includes(r)||e.country.toLowerCase().includes(r)||e.timezone.toLowerCase().includes(r)}),g=e=>{let t=u(e.name,e.timezone);a({name:"".concat(t).concat(s("timer.time","时间")),timezone:e.timezone,city:t,country:h(e.country),color:e.color,skipToColorStep:!1})},b=e=>{let t=["#1890FF","#52C41A","#722ED1","#13C2C2","#FA8C16","#FAAD14","#F759AB","#FF7A45"],r=t[Math.floor(Math.random()*t.length)],n=u(e.city,e.timezone);a({name:"".concat(n).concat(s("timer.time","时间")),timezone:e.timezone,city:n,country:h(e.country),color:r,skipToColorStep:!1})};return(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm overflow-y-auto py-4",onClick:t,children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-2xl m-4 p-6 rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:s("modal.addWorldClock.selectWorldClock","选择世界时间")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),!c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:s("modal.addWorldClock.popularCities","常用城市")}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-6 overflow-x-hidden",children:I.map(e=>{let t=u(e.name,e.timezone),a=h(e.country);return(0,r.jsx)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-3 rounded-lg glass-card hover:bg-white/10 dark:hover:bg-black/10 transition-colors text-left min-w-0",onClick:()=>g(e),"data-umami-event":"选择常用世界时间-".concat(t),children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 min-w-0",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:e.color+"20",color:e.color},children:(0,r.jsx)(d.i63,{className:"text-sm"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"font-medium truncate",children:t}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:a})]})]})},e.id)})}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("button",{className:"px-4 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600",onClick:()=>m(!0),"data-umami-event":"查看所有时区",children:s("modal.addWorldClock.viewMoreTimezones","查看更多时区")})})]}),c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.jRj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:s("modal.timezone.search","搜索城市或国家..."),value:o,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"})]})}),(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto overflow-x-hidden",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:y.map((e,t)=>{let a=u(e.city,e.timezone),n=h(e.country);return(0,r.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-2 rounded-lg hover:bg-white/10 dark:hover:bg-black/10 transition-colors text-left min-w-0",onClick:()=>b(e),"data-umami-event":"选择时区-".concat(a),children:[(0,r.jsx)("div",{className:"font-medium truncate",children:a}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:[n," - ",e.timezone]})]},t)})})}),(0,r.jsx)("div",{className:"mt-4 flex justify-center",children:(0,r.jsx)("button",{className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>m(!1),children:s("modal.addWorldClock.backToPopular","返回常用城市")})})]}),(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:t,children:s("common.cancel","取消")})})]})})}let B=["#1890FF","#52C41A","#722ED1","#13C2C2","#FA8C16","#FAAD14","#F759AB","#FF7A45","#69C0FF","#95DE64","#B37FEB","#5CDBD3","#FFC069","#85A5FF","#FF9C6E","#FF85C0","#36CFC9","#FFC53D","#BFBFBF","#2F54EB"];function _(e){let{onClose:t}=e,{addTimer:a}=(0,m.H)(),{accentColor:s}=(0,u.Fg)(),{t:o}=(0,x.$)(),[l,c]=(0,n.useState)(1),[h,y]=(0,n.useState)(!1),[g,b]=(0,n.useState)({name:"",timezone:"",city:"",country:"",color:B[0]}),f=e=>{b(t=>({...t,color:e}))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm overflow-y-auto py-4",onClick:t,children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-md m-4 p-6 rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[1===l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:o("modal.addWorldClock.create","创建世界时间")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),"              ",(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("button",{className:"w-full glass-card p-4 mb-4 text-left flex items-center hover:bg-white/10 dark:hover:bg-black/10",onClick:()=>y(!0),"data-umami-event":"选择世界时间时区",children:[(0,r.jsx)(d.RsK,{className:"mr-2 text-primary-500"}),(0,r.jsx)("span",{children:o("modal.addWorldClock.selectTimezoneAndCity","选择时区和城市")})]})}),g.timezone&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg mb-4",children:[(0,r.jsx)("h3",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:o("modal.addWorldClock.selectedTimezone","已选择时区")}),(0,r.jsxs)("div",{className:"text-blue-600 dark:text-blue-300",children:[(0,r.jsx)("div",{className:"font-medium",children:g.city}),(0,r.jsx)("div",{className:"text-sm",children:g.country}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:g.timezone})]})]}),(0,r.jsx)("form",{className:"space-y-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"时间名称"}),(0,r.jsx)("input",{type:"text",name:"name",value:g.name,onChange:e=>{let{name:t,value:a}=e.target;b(e=>({...e,[t]:a}))},placeholder:"例如: ".concat(g.city,"时间"),className:"w-full px-4 py-2 rounded-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none",required:!0})]})})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:t,children:o("common.cancel","取消")}),g.timezone&&(0,r.jsx)("button",{className:"btn-glass-primary",onClick:()=>c(2),disabled:!g.name,"data-umami-event":"下一步-选择世界时间颜色",children:o("common.next","下一步")})]})]}),2===l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:o("modal.addWorldClock.selectColor","选择颜色")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsx)("div",{className:"flex justify-center mb-6",children:(0,r.jsx)("div",{className:"w-24 h-24 rounded-full",style:{backgroundColor:g.color}})}),(0,r.jsx)(p.gW,{color:g.color,onChange:f,className:"w-full mb-6"}),(0,r.jsx)("div",{className:"grid grid-cols-5 gap-2 mb-6",children:B.map(e=>(0,r.jsx)("button",{className:"w-full aspect-square rounded-full ".concat(g.color===e?"ring-2 ring-white":""),style:{backgroundColor:e},onClick:()=>f(e),"data-umami-event":"选择世界时间预设颜色-".concat(e)},e))}),(0,r.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:()=>c(1),children:o("common.previous","上一步")}),(0,r.jsx)("button",{className:"btn-glass-primary",onClick:()=>{let e={name:g.name,type:"worldclock",timezone:g.timezone,city:g.city,country:g.country,color:g.color};a(e),c(3),setTimeout(()=>{t()},2e3)},"data-umami-event":"创建世界时间-确认",children:o("common.create","创建")})]})]}),3===l&&(0,r.jsxs)("div",{className:"py-8 text-center",children:[(0,r.jsx)(i.E.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"w-16 h-16 mx-auto mb-4 rounded-full bg-blue-500 flex items-center justify-center",children:(0,r.jsx)(d.UgA,{className:"text-white text-3xl"})}),(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:"世界时间已创建"}),(0,r.jsxs)("p",{className:"text-gray-500 dark:text-gray-400",children:[g.city,o("timer.successfullyCreated","时间已成功创建")]})]})]})}),h&&(0,r.jsx)(M,{onClose:()=>y(!1),onSelectWorldClock:e=>{b(t=>({...t,...e})),y(!1)}})]})}function H(e){let{onClose:t,onSelectType:a}=e,{accentColor:n}=(0,u.Fg)(),{t:s}=(0,x.$)(),o=[{id:"countdown",name:s("timer.countdown","倒计时"),description:s("timer.countdownDesc","设置目标时间，倒数到零"),icon:d.TCC,color:"#FF4D4F"},{id:"stopwatch",name:s("timer.stopwatch","正计时"),description:s("timer.stopwatchDesc","从零开始计时，记录经过时间"),icon:d.BVE,color:"#52C41A"},{id:"worldclock",name:s("timer.worldClock","世界时间"),description:s("timer.worldClockDesc","显示不同时区的当前时间"),icon:d.RsK,color:"#1890FF"}];return(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm overflow-y-auto py-4",onClick:t,children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-md m-4 p-6 rounded-2xl",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:s("timer.selectType","选择计时器类型")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsx)("div",{className:"space-y-4",children:o.map(e=>{let t=e.icon;return(0,r.jsx)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full p-4 rounded-xl glass-card hover:bg-white/10 dark:hover:bg-black/10 transition-colors text-left",onClick:()=>a(e.id),"data-umami-event":"选择计时器类型-".concat(e.name),children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{backgroundColor:e.color+"20",color:e.color},children:(0,r.jsx)(t,{className:"text-xl"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-lg",children:e.name}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:e.description})]})]})},e.id)})}),(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsx)("button",{className:"btn-glass-secondary",onClick:t,children:s("common.cancel","取消")})})]})})}function R(e){let{onClose:t}=e,{timers:a,activeTimerId:s}=(0,m.H)(),{accentColor:o}=(0,u.Fg)(),{t:l}=(0,x.$)(),[c,y]=(0,n.useState)(""),[g,b]=(0,n.useState)(!1),[p,f]=(0,n.useState)(s),[v,j]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=function(e){let t=e.map(e=>({id:e.id,name:e.name,targetDate:e.targetDate,timezone:e.timezone,color:e.color})),a=JSON.stringify({timers:t});return btoa(encodeURIComponent(a))}(v?a:a.filter(e=>e.id===p)),t="".concat(window.location.origin).concat(window.location.pathname,"?share=").concat(e);y(t)},[a,p,v]);let w=[{value:"all",label:l("share.shareAll","分享所有计时器")},...a.map(e=>({value:e.id,label:e.name}))];return(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm overflow-y-auto py-4",onClick:t,children:(0,r.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card w-full max-w-md m-4 p-6 rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold",children:l("share.title")}),(0,r.jsx)("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",onClick:t,children:(0,r.jsx)(d.q5L,{className:"text-xl"})})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(E,{name:"shareTimer",value:v?"all":p,onChange:e=>{"all"===e.target.value?j(!0):(j(!1),f(e.target.value))},options:w,placeholder:l("share.selectTimer","选择要分享的倒计时"),label:l("share.selectTimer","选择要分享的倒计时"),icon:d.SnF,"data-umami-event":"选择分享计时器"})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:l("share.url")}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("input",{type:"text",value:c,readOnly:!0,className:"flex-1 px-4 py-2 rounded-l-lg bg-white/10 dark:bg-black/10 backdrop-blur-sm border border-white/20 dark:border-white/10 focus:ring-2 focus:ring-primary-500 focus:outline-none"}),(0,r.jsx)("button",{className:"px-4 py-2 rounded-r-lg text-white",style:{backgroundColor:g?"#10b981":o},onClick:()=>{navigator.clipboard.writeText(c).then(()=>{b(!0),setTimeout(()=>b(!1),2e3)}).catch(e=>{console.error(l("share.copyError","无法复制URL: "),e)})},"data-umami-event":"复制分享链接",children:g?(0,r.jsx)(d.UgA,{}):(0,r.jsx)(d.C3L,{})})]})]}),(0,r.jsx)("div",{className:"mb-6 flex justify-center",children:(0,r.jsx)("div",{className:"p-4 bg-white rounded-xl",children:(0,r.jsx)(h.tv,{value:c,size:200,level:"H",includeMargin:!0,imageSettings:{src:"/favicon.ico",x:void 0,y:void 0,height:24,width:24,excavate:!0}})})}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{className:"flex-1 btn-glass-secondary flex items-center justify-center",onClick:t,children:l("common.close")}),navigator.share&&(0,r.jsxs)("button",{className:"flex-1 btn-glass-primary flex items-center justify-center",onClick:()=>{navigator.share&&navigator.share({title:l("share.shareTitle","查看我的TimePulse倒计时"),text:l("share.shareText","我分享了一个倒计时，点击链接查看"),url:c}).catch(e=>{console.log(l("share.shareError","分享失败:"),e)})},"data-umami-event":l("share.systemShare","使用系统分享"),children:[(0,r.jsx)(d.PMT,{className:"mr-2"}),l("share.systemShare","系统分享")]})]})]})})}var O=a(6989);function q(){let{timers:e,activeTimerId:t,setActiveTimerId:a,addTimer:l}=(0,m.H)(),{theme:c,accentColor:d}=(0,u.Fg)(),{t:h}=(0,x.$)(),y=(0,s.useRouter)(),[g,p]=(0,n.useState)(!1),[f,v]=(0,n.useState)(!1),[j,N]=(0,n.useState)(!1),[C,E]=(0,n.useState)(!1),[S,A]=(0,n.useState)(!1),[F,D]=(0,n.useState)(!1),[I,P]=(0,n.useState)(!1),[M,B]=(0,n.useState)(!1),[q,W]=(0,n.useState)([]),[U,Z]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=()=>{let e=window.scrollY,t=window.innerHeight,a=document.documentElement.scrollHeight;Z(e+t>=a-300)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);let K=e=>{W(t=>[...t,"[".concat(new Date().toLocaleTimeString(),"] ").concat(e)])},$=()=>{E(!1),A(!1),D(!1),P(!1),p(!1),"#add"===window.location.hash&&(window.location.hash="")};return(0,n.useEffect)(()=>{if(y.query.share)try{let e=function(e){try{let t=decodeURIComponent(atob(e));return JSON.parse(t)}catch(e){return console.error("解析分享URL失败:",e),null}}(y.query.share);e.timers&&e.timers.length>0&&(e.timers.forEach(e=>{l(e)}),a(e.timers[0].id),K("已从分享链接导入计时器数据"))}catch(e){K("解析分享数据错误: ".concat(e.message))}},[y.query.share,l,a]),(0,n.useEffect)(()=>{K("TimePulse 初始化完成"),K("当前主题: ".concat(c)),K("加载了 ".concat(e.length," 个计时器"))},[c,e.length]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(w,{children:[(0,r.jsx)(k,{}),(0,r.jsx)("main",{className:"relative flex flex-col items-center justify-center min-h-screen py-12 z-10",children:(0,r.jsx)(z,{})})]}),(0,r.jsx)(i.E.div,{className:"fixed bottom-6 right-6",style:{zIndex:50},animate:{opacity:U?0:1,scale:U?.8:1,pointerEvents:U?"none":"auto"},transition:{duration:.3},children:(0,r.jsx)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"p-4 rounded-full glass-card shadow-lg cursor-pointer",style:{color:d},onClick:()=>{E(!0),"#add"!==window.location.hash&&(window.location.hash="add")},"data-umami-event":h("timer.create"),children:(0,r.jsx)(O.wEH,{className:"text-xl"})})}),(0,r.jsx)(i.E.div,{className:"fixed bottom-6 left-6",style:{zIndex:50},animate:{opacity:U?0:1,scale:U?.8:1,pointerEvents:U?"none":"auto"},transition:{duration:.3},children:(0,r.jsx)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"p-4 rounded-full glass-card shadow-lg cursor-pointer",style:{color:d},onClick:()=>{v(!0),"#share"!==window.location.hash&&(window.location.hash="share")},"data-umami-event":h("timer.share"),children:(0,r.jsx)(O.PPi,{className:"text-xl"})})}),"      ",(0,r.jsx)(o.M,{children:C&&(0,r.jsx)(H,{onClose:$,onSelectType:e=>{switch(E(!1),e){case"countdown":A(!0);break;case"stopwatch":D(!0);break;case"worldclock":P(!0)}}})}),(0,r.jsx)(o.M,{children:S&&(0,r.jsx)(T,{onClose:$})}),(0,r.jsx)(o.M,{children:F&&(0,r.jsx)(L,{onClose:$})}),(0,r.jsx)(o.M,{children:I&&(0,r.jsx)(_,{onClose:$})}),(0,r.jsx)(o.M,{children:g&&(0,r.jsx)(T,{onClose:()=>{p(!1),"#add"===window.location.hash&&(window.location.hash="")}})}),(0,r.jsx)(o.M,{children:f&&(0,r.jsx)(R,{onClose:()=>{v(!1),"#share"===window.location.hash&&(window.location.hash="")}})}),(0,r.jsx)(o.M,{children:j&&(0,r.jsx)(b,{onClose:()=>{N(!1),"#login"===window.location.hash&&(window.location.hash="")}})})]})}}},function(e){e.O(0,[0,411,774,888,179],function(){return e(e.s=4625)}),_N_E=e.O()}]);